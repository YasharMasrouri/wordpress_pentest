import requests
import xml.etree.ElementTree as ET

# Prompt the user for the URL
url = input("Enter the WordPress website URL: ").strip()

# Remove trailing slash if it exists
url = url.rstrip('/')

# XML-RPC payload to retrieve available methods
xml_payload = '''<?xml version="1.0" encoding="UTF-8"?>
<methodCall>
  <methodName>system.listMethods</methodName>
  <params></params>
</methodCall>
'''

# Set headers
headers = {
    'Host': url[8:],
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36',
    'Content-Type': 'application/xml'
}

# Send the request
response = requests.post(url + '/xmlrpc.php', data=xml_payload, headers=headers)

# Print the response status code
print(response.status_code)

# Check if XML-RPC is active
if response.status_code == 200:
    print("XML-RPC is active on the WordPress website.")
    # Parse the response XML
    root = ET.fromstring(response.content)
    methods = root.findall(".//value/string")
    if methods:
        print("Active XML-RPC methods:", end=' ')
        available_methods = [method.text.strip() for method in methods]
        for method in methods:
            print(method.text, end=', ')
        print("")

        # Check for specific methods
        if 'wp.getUserBlogs' in available_methods:
            print("wp.getUserBlogs method is available.")
        else:
            print("wp.getUserBlogs method is not available.")

        if 'wp.getUsersBlogs' in available_methods:
            print("wp.getUsersBlogs method is available.")
        else:
            print("wp.getUsersBlogs method is not available.")

        if 'wp.getCategories' in available_methods:
            print("wp.getCategories method is available.")
        else:
            print("wp.getCategories method is not available.")

        if 'metaWeblog.getUsersBlogs' in available_methods:
            print("metaWeblog.getUsersBlogs method is available.")
        else:
            print("metaWeblog.getUsersBlogs method is not available.")

    else:
        print("No XML-RPC methods found.")
else:
    print("XML-RPC is not active on the WordPress website.")
